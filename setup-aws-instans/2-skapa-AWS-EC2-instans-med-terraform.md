# Skapa AWS EC2 instans med terraform
1. Installera AWS CLI. Följ installationsinstruktioner som gäller för ditt OS, https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html
2. För att kunna använda AWS CLI, skapa en access key och secret i AWS Sandbox, https://knowit-sandboxes.awsapps.com/start#/. Gå till Identity and Access Management (IAM) och lägg till (Add users). Skapa en användare under ditt namn. Tryck på den skapade användaren och gå till fliken Security Credentials. Scrolla ned och tryck Create access key för att skapa en. Välj Command Line Interface (CLI), markera och godkänn "I understand the above recommendation..." och tryck på Next. Ange en valfri beskrivning för access nyckeln i nästa steg och tryck på Next. Anteckna access key och secret, spara till exempel i en lokal textfil.
3. Installera Terraform CLI. Följ installationsinstruktioner som gäller för ditt OS, https://developer.hashicorp.com/terraform/tutorials/aws-get-started/install-cli
4. Gå till mappen setup-aws-instans i repot https://github.com/domcha-knowit/docker-k8s-kurs-och-cert. Editera filen kubernetes.tf, ändra alla förekomster av "domcha" och ange valfritt unikt namn t.ex. de tre första bokstäverna i ditt förnamn och tre första bokstäverna i ditt efternamn. Spara dina ändringar i kubernetes.tf filen. Kör kommandot `terraform init` och sedan kommandot `terraform apply` för att starta en instans. Svara yes vid nästa steg.
5. Kör kommandot `aws ec2 describe-instances --query "Reservations[*].Instances[*].{PublicIP:PublicDnsName,Type:InstanceType,Name:Tags[?Key=='Name']|[0].Value,Status:State.Name}" --filters "Name=instance-state-name,Values=running" --output table > output.txt` för att lista alla EC2 instanser. Outputen sparas i filen output.txt. Öppna den och ta reda på vilken instans och tillhörande hostnamn som du har skapat.
6. SSH:a till instansen med kommandot, `ssh -i ~/.ssh/aws-linux-demo.pem ubuntu@<hostnamn-till-din-EC2-instans>`
7. För att ta ned AWS instansen, kör kommandot `terraform destroy`. Svara yes vid nästa steg.
